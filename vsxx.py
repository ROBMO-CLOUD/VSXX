import base64
exec(base64.b64decode('ZnJvbSB0ZWxldGhvbiBpbXBvcnQgVGVsZWdyYW1DbGllbnQsIGV2ZW50cwppbXBvcnQgdGVsZWJvdAppbXBvcnQgcmUKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBhc3luY2lvCmltcG9ydCByYW5kb20KZnJvbSBvcyBpbXBvcnQgc3lzdGVtLCBuYW1lCmZyb20gYmluIGltcG9ydCBnZXRfYmluX2luZm8KZnJvbSBhcGlzIGltcG9ydCBhcGlkLCBhcGloYXNkLCB0b2tlbgoKbm93ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKbWVzX2FjdHVhbCA9IG5vdy5tb250aAphbm9fYWN0dWFsID0gbm93LnllYXIKCmNsaWVudCA9IFRlbGVncmFtQ2xpZW50KCdzY3JhcGZyZWUnLCBhcGlkLCBhcGloYXNkKQpjbGllbnQucGFyc2VfbW9kZSA9ICdodG1sJwoKYm90ID0gdGVsZWJvdC5UZWxlQm90KHRva2VuLCBwYXJzZV9tb2RlPSJodG1sIikKCmlkX2NoYW5uZWwgPSAtMTAwMjQ1MDI0NzkxMwppZF9hbGVydF9jaGFubmVsID0gLTEwMDI0MzIxNzkwMDcKCmNhcmRzX3Byb2Nlc3MgPSB7fQoKYXN5bmMgZGVmIGhhbmRsZV9sb2dpbl9pc3N1ZSgpOgogICAgdHJ5OgogICAgICAgIGF3YWl0IGJvdC5zZW5kX21lc3NhZ2UoCiAgICAgICAgICAgIGlkX2FsZXJ0X2NoYW5uZWwsCiAgICAgICAgICAgICLimqDvuI8gRWwgYm90IG5lY2VzaXRhIGluaWNpYXIgc2VzacOzbiBudWV2YW1lbnRlLiIKICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJFcnJvciBhbGVydGEgbG9naW46IHtlfSIpCgpAY2xpZW50Lm9uKGV2ZW50cy5OZXdNZXNzYWdlKQphc3luYyBkZWYgZWRpdGVkX2V2ZW50KGV2ZW50OiBldmVudHMpOgogICAgdHJ5OgogICAgICAgIHRleHRfbXNnID0gZXZlbnQucmF3X3RleHQKICAgIGV4Y2VwdCBNZW1vcnlFcnJvcjoKICAgICAgICByZXR1cm4KCiAgICBjYXJkX3BhdHRlcm4gPSByZS5jb21waWxlKHInXGIoXGR7MTZ9KVx8KFxkezJ9KVx8KFxkezR9KVx8KFxkezN9KVxiJykKICAgIG1hdGNoID0gY2FyZF9wYXR0ZXJuLmZpbmRhbGwodGV4dF9tc2cpCgogICAgaWYgbm90IG1hdGNoOgogICAgICAgIHJldHVybgoKICAgIGNjLCBtZXMsIGFubywgY3Z2ID0gbWF0Y2hbMF0KCiAgICBpZiBjYXJkc19wcm9jZXNzLmdldChjYywgMCkgPj0gMzoKICAgICAgICByZXR1cm4KCiAgICByYW5kb21fZGlnaXRzID0gIiIuam9pbihyYW5kb20uY2hvaWNlKCIwMTIzNDU2Nzg5IikgZm9yIF8gaW4gcmFuZ2UoNikpCgogICAgeCA9IGdldF9iaW5faW5mbyhjY1s6Nl0pCgogICAgdGV4dCA9IGYiIiIKPGI+PGEgaHJlZj0iaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1ZTWFgtU0NSUC9Db2RlL21haW4vc2NycC5qcGciPiYjODIwMzs8L2E+Cls8YSBocmVmPSJodHRwczovL3QubWUvK0NxTkFyZVVLQ190aVl6RmgiPuS5iDwvYT5dIPCdkJXwnZCS8J2Ql/CdkJcg8J2QkvCdkILwnZCR8J2QgPCdkI/wnZCP8J2QhPCdkJEgLSDjgJAg8J2QhfCdkJHwnZCE8J2QhCDjgJEK4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCls8YSBocmVmPSJodHRwczovL3QubWUvK0NxTkFyZVVLQ190aVl6RmgiPuS5iDwvYT5dICNiaW57Y2NbOjZdfQrilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIEKWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gQ0Mg4p6rIDxjb2RlPntjY318e21lc318e2Fub318e2N2dn08L2NvZGU+CuKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgQpbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSBDb3VudHJ5IOKeqyA8Y29kZT57eC5nZXQoImNvdW50cnkiKX08L2NvZGU+IHwgPGNvZGU+e3guZ2V0KCJmbGFnIil9PC9jb2RlPgpbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSBUeXBlIOKeqyA8Y29kZT57eC5nZXQoInR5cGUiKX08L2NvZGU+IHwgPGNvZGU+e3guZ2V0KCJ2ZW5kb3IiKX08L2NvZGU+Cls8YSBocmVmPSJodHRwczovL3QubWUvK0NxTkFyZVVLQ190aVl6RmgiPuS5iDwvYT5dIExldmVsIOKeqyA8Y29kZT57eC5nZXQoImxldmVsIil9PC9jb2RlPgpbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSBCYW5rIOKeqyA8Y29kZT57eC5nZXQoImJhbmtfbmFtZSIpfTwvY29kZT4K4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCls8YSBocmVmPSJodHRwczovL3QubWUvK0NxTkFyZVVLQ190aVl6RmgiPuS5iDwvYT5dIEV4dHJhIOKeqyA8Y29kZT57Y2NbOjhdfXtyYW5kb21fZGlnaXRzfXh4eHh8e21lc318e2Fub318cm5kPC9jb2RlPgpbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSBQb3dlcmVkIGJ5IOKeqyA8YSBocmVmPSJodHRwczovL3QubWUvQ0wwVURfQURNSU4iPkBDTDBVRF9BRE1JTiDwn6WAPC9hPgo8L2I+CiIiIgoKICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoMzEuNSkKCiAgICB0cnk6CiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShpZF9jaGFubmVsLCB0ZXh0LCBwYXJzZV9tb2RlPSJIVE1MIikKICAgIGV4Y2VwdDoKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKGlkX2NoYW5uZWwsIHRleHQsIGRpc2FibGVfd2ViX3BhZ2VfcHJldmlldz1UcnVlKQoKICAgIGNhcmRzX3Byb2Nlc3NbY2NdID0gY2FyZHNfcHJvY2Vzcy5nZXQoY2MsIDApICsgMQoKCmFzeW5jIGRlZiBtYWluKCk6CiAgICBzeXN0ZW0oJ2NscycgaWYgbmFtZSA9PSAnbnQnIGVsc2UgJ2NsZWFyJykKICAgIHByaW50KCdAQ0wwVURfQURNSU4nKQoKICAgIHRyeToKICAgICAgICBhd2FpdCBjbGllbnQuc3RhcnQoKQogICAgICAgIGF3YWl0IGNsaWVudC5ydW5fdW50aWxfZGlzY29ubmVjdGVkKCkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIuKdjCBFcnJvciBpbmljaW86IHtlfSIpCiAgICAgICAgYXdhaXQgaGFuZGxlX2xvZ2luX2lzc3VlKCkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgYXN5bmNpby5ydW4obWFpbigpKQo=').decode('utf-8'))
